(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[435],{26435:function(e,t,i){"use strict";i.r(t),i.d(t,{HomeModule:function(){return N}});var r=i(61116),o=i(2937),n=i(31041),s=i(63337),a=i(56967),c=i(31431),l=i(92935),u=i(59472),p=i(47701),h=i(98720),g=i(66599),f=i(35366),d=i(59411),m=i(730),v=i(3492),x=i(38611),Z=i(35965),F=i(13070),y=i(9550),b=i(13841),A=i(87064),q=i(26470),k=i(84369);function w(e,t){if(1&e&&(f.TgZ(0,"mat-option",8),f._uU(1),f.qZA()),2&e){const e=t.$implicit;f.Q6J("value",e),f.xp6(1),f.hij(" ",e," ")}}function T(e,t){if(1&e&&(f.TgZ(0,"mat-option",8),f._uU(1),f.qZA()),2&e){const e=t.$implicit,i=f.oxw();f.Q6J("value",e),f.xp6(1),f.hij(" ",i.genreName[e]," ")}}function C(e,t){1&e&&(f.TgZ(0,"div",12),f._uU(1,"Searching...."),f.qZA())}function _(e,t){if(1&e&&(f.TgZ(0,"span",29),f._uU(1),f.qZA()),2&e){const e=t.$implicit,i=f.oxw(3);f.xp6(1),f.Oqu(i.genreName[e])}}function S(e,t){if(1&e&&(f.TgZ(0,"div",1),f.YNc(1,_,2,1,"span",28),f.qZA()),2&e){const e=f.oxw().$implicit;f.xp6(1),f.Q6J("ngForOf",e.genre)}}function J(e,t){if(1&e){const e=f.EpF();f.TgZ(0,"button",30),f.NdJ("click",function(){f.CHM(e);const t=f.oxw().$implicit;return f.oxw().addToFavourites(t)}),f._uU(1," Add to Favourites "),f.qZA()}}function M(e,t){if(1&e){const e=f.EpF();f.TgZ(0,"button",31),f.NdJ("click",function(){f.CHM(e);const t=f.oxw().$implicit;return f.oxw().removeFromFavourites(t)}),f._uU(1," Remove from Favourites "),f.qZA()}}function U(e,t){if(1&e){const e=f.EpF();f.ynx(0),f.TgZ(1,"div",13),f.TgZ(2,"div",14),f.TgZ(3,"div",1),f.TgZ(4,"app-photo-preview",15),f.NdJ("click",function(){const t=f.CHM(e).$implicit;return f.oxw().showMovieDetails(t)}),f.qZA(),f.qZA(),f.qZA(),f.TgZ(5,"div",16),f.TgZ(6,"div",17),f.TgZ(7,"div",18),f.NdJ("click",function(){const t=f.CHM(e).$implicit;return f.oxw().showMovieDetails(t)}),f._uU(8," Name: "),f.TgZ(9,"span",19),f._uU(10),f.qZA(),f.qZA(),f.TgZ(11,"div",1),f._uU(12,"Year: "),f.TgZ(13,"span",19),f._uU(14),f.qZA(),f.qZA(),f.qZA(),f.TgZ(15,"div",20),f.TgZ(16,"div",21),f._uU(17,"Rating:"),f.qZA(),f.TgZ(18,"div",22),f.TgZ(19,"span"),f._uU(20),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(21,"div",23),f.YNc(22,S,2,1,"div",24),f.qZA(),f.TgZ(23,"div",25),f.YNc(24,J,2,0,"button",26),f.YNc(25,M,2,0,"button",27),f.qZA(),f.qZA(),f.BQk()}if(2&e){const e=t.$implicit;f.xp6(4),f.Q6J("size","40px")("photoURL",e.posterURL),f.xp6(6),f.Oqu(e.name),f.xp6(4),f.Oqu(e.year),f.xp6(6),f.Oqu(e.rating),f.xp6(2),f.Q6J("ngIf",e.genre.length),f.xp6(2),f.Q6J("ngIf",!e.isFavourite),f.xp6(1),f.Q6J("ngIf",e.isFavourite)}}const B=[{path:"",component:(()=>{class e{constructor(e,t,i,r,o,s){this.dialog=e,this.usersService=t,this.cdr=i,this.stateService=r,this.toastr=o,this.apiService=s,this.movies=[],this.favourites=[],this.sortBy="name",this.loading=!1,this.firstLoad=!0,this.searchField=new n.NI,this.apiKeySubscription=this.stateService.getApiKey().subscribe(e=>{this.searchMovies(this.searchField.value)}),this.moviesSubscription=this.stateService.getUser().subscribe(e=>{e&&e.id?(this.activeUser=e,this.cdr.markForCheck()):(this.activeUser={},this.cdr.markForCheck())})}get movieYears(){return[...new Set(this.movies.map(e=>e.year))].sort((e,t)=>t-e)}get movieGenres(){const e=this.flatten(this.movies.map(e=>e.genre));return[...new Set(e)]}get sortedAndFilteredMovies(){let e=[...this.movies];return this.filterByYear&&(e=[...e.filter(e=>e.year===this.filterByYear)]),this.filterByGenre&&(e=[...e.filter(e=>e.genre.includes(this.filterByGenre))]),e}get favouriteMoviesIDs(){return this.favourites&&this.favourites.length?this.favourites.map(e=>e.id):[]}ngOnInit(){this.fetchGenres(),this.searchField.valueChanges.pipe((0,p.b)(600),(0,h.x)(),(0,g.b)(e=>{this.loading=!0}),(0,g.b)(e=>this.loading=!1)).subscribe(e=>{this.searchMovies(e)}),this.readFavourites()}ngOnDestroy(){this.apiKeySubscription&&this.apiKeySubscription.unsubscribe(),this.moviesSubscription&&this.moviesSubscription.unsubscribe()}searchMovies(e){e&&(this.genreName?this.doMovieSearch(e):this.fetchGenres())}doMovieSearch(e){this.apiService.search(e).subscribe(e=>{let t;this.movies=[],e.results.forEach(e=>{t={name:e.original_title,year:e.release_date?e.release_date.split("-")[0]:"-",genre:e.genre_ids,rating:e.vote_average,posterURL:e.poster_path?"https://image.tmdb.org/t/p/w440_and_h660_face"+e.poster_path:"https://www.allianceplast.com/wp-content/uploads/2017/11/no-image.png",description:e.overview,id:e.id,isFavourite:this.favouriteMoviesIDs.includes(e.id)},this.movies.push(t)}),this.doSort(),this.cdr.markForCheck()},e=>{this.firstLoad||this.toastr.error("API Key invalid")})}fetchGenres(){this.apiService.getGenres().subscribe(e=>{this.genreName=e.genres.reduce((e,t)=>(e[t.id]=t.name,e),{}),this.searchField.value&&this.doMovieSearch(this.searchField.value),this.firstLoad=!1},e=>{this.firstLoad||this.toastr.error("API Key invalid"),this.firstLoad=!1})}readFavourites(){const e=localStorage.getItem("favourites");if(e){const t=JSON.parse(e);t&&(this.favourites=t,this.cdr.markForCheck())}}showMovieDetails(e){const t=new l.vA;t.width="500px",t.hasBackdrop=!0,t.closeOnNavigation=!0;const i=this.dialog.open(u.F,t);i.componentInstance.movie=e,i.afterClosed().subscribe(e=>{e&&this.cdr.markForCheck()})}updateSort(){this.doSort(),this.cdr.markForCheck()}doSort(){"year"===this.sortBy?this.movies.sort((e,t)=>t.year-e.year):"name"===this.sortBy&&this.movies.sort((e,t)=>e.name.localeCompare(t.name)),this.cdr.markForCheck()}addToFavourites(e){e.isFavourite=!0;const t=this.movies.filter(e=>e.isFavourite);localStorage.setItem("favourites",JSON.stringify(t)),this.cdr.markForCheck()}removeFromFavourites(e){e.isFavourite=!1;const t=this.movies.filter(e=>e.isFavourite);localStorage.setItem("favourites",JSON.stringify(t)),this.cdr.markForCheck()}doYearFilter(){0===this.filterByYear&&(this.filterByYear=null,this.cdr.markForCheck())}doGenreFilter(){0===this.filterByGenre&&(this.filterByGenre=null,this.cdr.markForCheck())}flatten(e){return e.reduce((e,t)=>e.concat(Array.isArray(t)?this.flatten(t):t),[])}}return e.\u0275fac=function(t){return new(t||e)(f.Y36(l.uw),f.Y36(d.K),f.Y36(f.sBO),f.Y36(m.b),f.Y36(v._W),f.Y36(x.s))},e.\u0275cmp=f.Xpm({type:e,selectors:[["app-home"]],decls:37,vars:12,consts:[["fxFlex","100","fxLayout","row wrap",1,"home-page"],["fxFlex","100"],["appearance","outline",1,"form-field"],["matInput","",3,"formControl"],["searchInput",""],["appearance","outline",1,"btr-form-field"],[3,"ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["class","searching","fxFlex","100",4,"ngIf"],["fxLayout","row wrap","fxLayoutGap","10px","fxFlex","100",1,"movies-container"],[4,"ngFor","ngForOf"],["fxFlex","100",1,"searching"],["fxFlex","1 1 24","fxFlex.lt-lg","0 1 48","fxFlex.lt-sm","0 1 95","fxLayout","row wrap",1,"movie"],["fxFlex","calc(50px)"],[3,"size","photoURL","click"],["fxFlex","calc(100%-50px)","fxLayout","row wrap"],["fxFlex","calc(100%-60px)","fxLayout","row wrap","fxLayoutAlign","start start",1,"user-info"],["fxFlex","100",1,"pointer",3,"click"],[1,"bold"],["fxFlex","calc(60px)","fxLayout","row wrap","fxLayoutAlign","center start",1,"skill-wrapper"],["fxFlex","100",1,"skill-label","text-center"],["fxFlex","100",1,"skill-rating","text-center","pointer"],["fxFlex","100","fxLayoutAlign","start center"],["fxFlex","100",4,"ngIf"],["fxFlex","100","fxLayoutAlign","center center"],["mat-button","","color","primary",3,"click",4,"ngIf"],["mat-button","","color","warn",3,"click",4,"ngIf"],["class","genre-token",4,"ngFor","ngForOf"],[1,"genre-token"],["mat-button","","color","primary",3,"click"],["mat-button","","color","warn",3,"click"]],template:function(e,t){1&e&&(f.TgZ(0,"div",0),f.TgZ(1,"h2",1),f._uU(2,"Movie DB"),f.qZA(),f.TgZ(3,"span"),f.TgZ(4,"mat-form-field",2),f.TgZ(5,"mat-label"),f._uU(6,"Search Movies"),f.qZA(),f._UZ(7,"input",3,4),f.qZA(),f.qZA(),f.TgZ(9,"span"),f.TgZ(10,"mat-form-field",5),f.TgZ(11,"mat-label"),f._uU(12,"Filter By Year"),f.qZA(),f.TgZ(13,"mat-select",6),f.NdJ("ngModelChange",function(e){return t.filterByYear=e})("selectionChange",function(){return t.doYearFilter()}),f.YNc(14,w,2,2,"mat-option",7),f.TgZ(15,"mat-option",8),f._uU(16," Clear Filter "),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(17,"span"),f.TgZ(18,"mat-form-field",5),f.TgZ(19,"mat-label"),f._uU(20,"Filter By Genre"),f.qZA(),f.TgZ(21,"mat-select",6),f.NdJ("ngModelChange",function(e){return t.filterByGenre=e})("selectionChange",function(){return t.doGenreFilter()}),f.YNc(22,T,2,2,"mat-option",7),f.TgZ(23,"mat-option",8),f._uU(24," Clear Filter "),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(25,"span"),f.TgZ(26,"mat-form-field",5),f.TgZ(27,"mat-label"),f._uU(28,"Sorty By"),f.qZA(),f.TgZ(29,"mat-select",6),f.NdJ("ngModelChange",function(e){return t.sortBy=e})("selectionChange",function(){return t.updateSort()}),f.TgZ(30,"mat-option",8),f._uU(31," Sort by Year "),f.qZA(),f.TgZ(32,"mat-option",8),f._uU(33," Sort by Name "),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.YNc(34,C,2,0,"div",9),f.TgZ(35,"div",10),f.YNc(36,U,26,8,"ng-container",11),f.qZA(),f.qZA()),2&e&&(f.xp6(7),f.Q6J("formControl",t.searchField),f.xp6(6),f.Q6J("ngModel",t.filterByYear),f.xp6(1),f.Q6J("ngForOf",t.movieYears),f.xp6(1),f.Q6J("value",0),f.xp6(6),f.Q6J("ngModel",t.filterByGenre),f.xp6(1),f.Q6J("ngForOf",t.movieGenres),f.xp6(1),f.Q6J("value",0),f.xp6(6),f.Q6J("ngModel",t.sortBy),f.xp6(1),f.Q6J("value","year"),f.xp6(2),f.Q6J("value","name"),f.xp6(2),f.Q6J("ngIf",t.loading),f.xp6(2),f.Q6J("ngForOf",t.sortedAndFilteredMovies))},directives:[Z.yH,Z.xw,F.KE,F.hX,y.Nt,n.Fj,n.JJ,n.oH,b.gD,n.On,r.sg,A.ey,r.O5,Z.SQ,q.g,Z.Wh,k.lW],styles:[".movie[_ngcontent-%COMP%]{border:1px solid #673ab7;border-radius:5px;padding:15px 10px;margin-bottom:10px;min-width:250px}.home-page[_ngcontent-%COMP%]{padding:10px 20px}.skill-rating[_ngcontent-%COMP%]{font-weight:700;font-size:30px;border:1px solid;border-radius:10px;padding:10px 5px;line-height:35px;background-color:#000;color:#fff;max-height:55px}.genre-token[_ngcontent-%COMP%]{margin:3px;padding:3px 5px;border:1px solid #673ab7;border-radius:5px;background-color:#673ab7;color:#fff;font-size:10px;font-weight:700;display:inline-block}"],changeDetection:0}),e})()}];let N=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=f.oAB({type:e}),e.\u0275inj=f.cJS({providers:[],imports:[[r.ez,s.Bz,o.o9,n.u5,c.q,a.y,n.UX,s.Bz.forChild(B)]]}),e})()}}]);