!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(!e)return;if("string"==typeof e)return t(e,r);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return t(e,r)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[435],{26435:function(t,n,o){"use strict";o.r(n),o.d(n,{HomeModule:function(){return L}});var a=o(61116),s=o(2937),c=o(31041),u=o(63337),l=o(56967),f=o(31431),p=o(92935),g=o(59472),v=o(47701),d=o(98720),h=o(66599),m=o(35366),x=o(59411),y=o(730),Z=o(3492),F=o(38611),b=o(35965),k=o(13070),A=o(9550),w=o(13841),q=o(87064),T=o(26470),S=o(84369);function C(e,t){if(1&e&&(m.TgZ(0,"mat-option",8),m._uU(1),m.qZA()),2&e){var r=t.$implicit;m.Q6J("value",r),m.xp6(1),m.hij(" ",r," ")}}function _(e,t){if(1&e&&(m.TgZ(0,"mat-option",8),m._uU(1),m.qZA()),2&e){var r=t.$implicit,i=m.oxw();m.Q6J("value",r),m.xp6(1),m.hij(" ",i.genreName[r]," ")}}function M(e,t){1&e&&(m.TgZ(0,"div",12),m._uU(1,"Searching...."),m.qZA())}function J(e,t){if(1&e&&(m.TgZ(0,"span",29),m._uU(1),m.qZA()),2&e){var r=t.$implicit,i=m.oxw(3);m.xp6(1),m.Oqu(i.genreName[r])}}function U(e,t){if(1&e&&(m.TgZ(0,"div",1),m.YNc(1,J,2,1,"span",28),m.qZA()),2&e){var r=m.oxw().$implicit;m.xp6(1),m.Q6J("ngForOf",r.genre)}}function B(e,t){if(1&e){var r=m.EpF();m.TgZ(0,"button",30),m.NdJ("click",function(){m.CHM(r);var e=m.oxw().$implicit;return m.oxw().addToFavourites(e)}),m._uU(1," Add to Favourites "),m.qZA()}}function N(e,t){if(1&e){var r=m.EpF();m.TgZ(0,"button",31),m.NdJ("click",function(){m.CHM(r);var e=m.oxw().$implicit;return m.oxw().removeFromFavourites(e)}),m._uU(1," Remove from Favourites "),m.qZA()}}function O(e,t){if(1&e){var r=m.EpF();m.ynx(0),m.TgZ(1,"div",13),m.TgZ(2,"div",14),m.TgZ(3,"div",1),m.TgZ(4,"app-photo-preview",15),m.NdJ("click",function(){var e=m.CHM(r).$implicit;return m.oxw().showMovieDetails(e)}),m.qZA(),m.qZA(),m.qZA(),m.TgZ(5,"div",16),m.TgZ(6,"div",17),m.TgZ(7,"div",18),m.NdJ("click",function(){var e=m.CHM(r).$implicit;return m.oxw().showMovieDetails(e)}),m._uU(8," Name: "),m.TgZ(9,"span",19),m._uU(10),m.qZA(),m.qZA(),m.TgZ(11,"div",1),m._uU(12,"Year: "),m.TgZ(13,"span",19),m._uU(14),m.qZA(),m.qZA(),m.qZA(),m.TgZ(15,"div",20),m.TgZ(16,"div",21),m._uU(17,"Rating:"),m.qZA(),m.TgZ(18,"div",22),m.TgZ(19,"span"),m._uU(20),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(21,"div",23),m.YNc(22,U,2,1,"div",24),m.qZA(),m.TgZ(23,"div",25),m.YNc(24,B,2,0,"button",26),m.YNc(25,N,2,0,"button",27),m.qZA(),m.qZA(),m.BQk()}if(2&e){var i=t.$implicit;m.xp6(4),m.Q6J("size","40px")("photoURL",i.posterURL),m.xp6(6),m.Oqu(i.name),m.xp6(4),m.Oqu(i.year),m.xp6(6),m.Oqu(i.rating),m.xp6(2),m.Q6J("ngIf",i.genre.length),m.xp6(2),m.Q6J("ngIf",!i.isFavourite),m.xp6(1),m.Q6J("ngIf",i.isFavourite)}}var Y,I,Q=[{path:"",component:(Y=function(){function t(e,i,n,o,a,s){var u=this;r(this,t),this.dialog=e,this.usersService=i,this.cdr=n,this.stateService=o,this.toastr=a,this.apiService=s,this.movies=[],this.favourites=[],this.sortBy="name",this.loading=!1,this.firstLoad=!0,this.searchField=new c.NI,this.apiKeySubscription=this.stateService.getApiKey().subscribe(function(e){u.searchMovies(u.searchField.value)}),this.moviesSubscription=this.stateService.getUser().subscribe(function(e){e&&e.id?(u.activeUser=e,u.cdr.markForCheck()):(u.activeUser={},u.cdr.markForCheck())})}var n,o,a;return n=t,(o=[{key:"movieYears",get:function(){return e(new Set(this.movies.map(function(e){return e.year}))).sort(function(e,t){return t-e})}},{key:"movieGenres",get:function(){var t=this.flatten(this.movies.map(function(e){return e.genre}));return e(new Set(t))}},{key:"sortedAndFilteredMovies",get:function(){var t=this,r=e(this.movies);return this.filterByYear&&(r=e(r.filter(function(e){return e.year===t.filterByYear}))),this.filterByGenre&&(r=e(r.filter(function(e){return e.genre.includes(t.filterByGenre)}))),r}},{key:"favouriteMoviesIDs",get:function(){return this.favourites&&this.favourites.length?this.favourites.map(function(e){return e.id}):[]}},{key:"ngOnInit",value:function(){var e=this;this.fetchGenres(),this.searchField.valueChanges.pipe((0,v.b)(600),(0,d.x)(),(0,h.b)(function(t){e.loading=!0}),(0,h.b)(function(t){return e.loading=!1})).subscribe(function(t){e.searchMovies(t)}),this.readFavourites()}},{key:"ngOnDestroy",value:function(){this.apiKeySubscription&&this.apiKeySubscription.unsubscribe(),this.moviesSubscription&&this.moviesSubscription.unsubscribe()}},{key:"searchMovies",value:function(e){e&&(this.genreName?this.doMovieSearch(e):this.fetchGenres())}},{key:"doMovieSearch",value:function(e){var t=this;this.apiService.search(e).subscribe(function(e){var r;t.movies=[],e.results.forEach(function(e){r={name:e.original_title,year:e.release_date?e.release_date.split("-")[0]:"-",genre:e.genre_ids,rating:e.vote_average,posterURL:e.poster_path?"https://image.tmdb.org/t/p/w440_and_h660_face"+e.poster_path:"https://www.allianceplast.com/wp-content/uploads/2017/11/no-image.png",description:e.overview,id:e.id,isFavourite:t.favouriteMoviesIDs.includes(e.id)},t.movies.push(r)}),t.doSort(),t.cdr.markForCheck()},function(e){t.firstLoad||t.toastr.error("API Key invalid")})}},{key:"fetchGenres",value:function(){var e=this;this.apiService.getGenres().subscribe(function(t){e.genreName=t.genres.reduce(function(e,t){return e[t.id]=t.name,e},{}),e.searchField.value&&e.doMovieSearch(e.searchField.value),e.firstLoad=!1},function(t){e.firstLoad||e.toastr.error("API Key invalid"),e.firstLoad=!1})}},{key:"readFavourites",value:function(){var e=localStorage.getItem("favourites");if(e){var t=JSON.parse(e);t&&(this.favourites=t,this.cdr.markForCheck())}}},{key:"showMovieDetails",value:function(e){var t=this,r=new p.vA;r.width="500px",r.hasBackdrop=!0,r.closeOnNavigation=!0;var i=this.dialog.open(g.F,r);i.componentInstance.movie=e,i.afterClosed().subscribe(function(e){e&&t.cdr.markForCheck()})}},{key:"updateSort",value:function(){this.doSort(),this.cdr.markForCheck()}},{key:"doSort",value:function(){"year"===this.sortBy?this.movies.sort(function(e,t){return t.year-e.year}):"name"===this.sortBy&&this.movies.sort(function(e,t){return e.name.localeCompare(t.name)}),this.cdr.markForCheck()}},{key:"addToFavourites",value:function(e){e.isFavourite=!0;var t=this.movies.filter(function(e){return e.isFavourite});localStorage.setItem("favourites",JSON.stringify(t)),this.cdr.markForCheck()}},{key:"removeFromFavourites",value:function(e){e.isFavourite=!1;var t=this.movies.filter(function(e){return e.isFavourite});localStorage.setItem("favourites",JSON.stringify(t)),this.cdr.markForCheck()}},{key:"doYearFilter",value:function(){0===this.filterByYear&&(this.filterByYear=null,this.cdr.markForCheck())}},{key:"doGenreFilter",value:function(){0===this.filterByGenre&&(this.filterByGenre=null,this.cdr.markForCheck())}},{key:"flatten",value:function(e){var t=this;return e.reduce(function(e,r){return e.concat(Array.isArray(r)?t.flatten(r):r)},[])}}])&&i(n.prototype,o),a&&i(n,a),t}(),Y.\u0275fac=function(e){return new(e||Y)(m.Y36(p.uw),m.Y36(x.K),m.Y36(m.sBO),m.Y36(y.b),m.Y36(Z._W),m.Y36(F.s))},Y.\u0275cmp=m.Xpm({type:Y,selectors:[["app-home"]],decls:37,vars:12,consts:[["fxFlex","100","fxLayout","row wrap",1,"home-page"],["fxFlex","100"],["appearance","outline",1,"form-field"],["matInput","",3,"formControl"],["searchInput",""],["appearance","outline",1,"btr-form-field"],[3,"ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["class","searching","fxFlex","100",4,"ngIf"],["fxLayout","row wrap","fxLayoutGap","10px","fxFlex","100",1,"movies-container"],[4,"ngFor","ngForOf"],["fxFlex","100",1,"searching"],["fxFlex","1 1 24","fxFlex.lt-lg","0 1 48","fxFlex.lt-sm","0 1 95","fxLayout","row wrap",1,"movie"],["fxFlex","calc(50px)"],[3,"size","photoURL","click"],["fxFlex","calc(100%-50px)","fxLayout","row wrap"],["fxFlex","calc(100%-60px)","fxLayout","row wrap","fxLayoutAlign","start start",1,"user-info"],["fxFlex","100",1,"pointer",3,"click"],[1,"bold"],["fxFlex","calc(60px)","fxLayout","row wrap","fxLayoutAlign","center start",1,"skill-wrapper"],["fxFlex","100",1,"skill-label","text-center"],["fxFlex","100",1,"skill-rating","text-center","pointer"],["fxFlex","100","fxLayoutAlign","start center"],["fxFlex","100",4,"ngIf"],["fxFlex","100","fxLayoutAlign","center center"],["mat-button","","color","primary",3,"click",4,"ngIf"],["mat-button","","color","warn",3,"click",4,"ngIf"],["class","genre-token",4,"ngFor","ngForOf"],[1,"genre-token"],["mat-button","","color","primary",3,"click"],["mat-button","","color","warn",3,"click"]],template:function(e,t){1&e&&(m.TgZ(0,"div",0),m.TgZ(1,"h2",1),m._uU(2,"Movie DB"),m.qZA(),m.TgZ(3,"span"),m.TgZ(4,"mat-form-field",2),m.TgZ(5,"mat-label"),m._uU(6,"Search Movies"),m.qZA(),m._UZ(7,"input",3,4),m.qZA(),m.qZA(),m.TgZ(9,"span"),m.TgZ(10,"mat-form-field",5),m.TgZ(11,"mat-label"),m._uU(12,"Filter By Year"),m.qZA(),m.TgZ(13,"mat-select",6),m.NdJ("ngModelChange",function(e){return t.filterByYear=e})("selectionChange",function(){return t.doYearFilter()}),m.YNc(14,C,2,2,"mat-option",7),m.TgZ(15,"mat-option",8),m._uU(16," Clear Filter "),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(17,"span"),m.TgZ(18,"mat-form-field",5),m.TgZ(19,"mat-label"),m._uU(20,"Filter By Genre"),m.qZA(),m.TgZ(21,"mat-select",6),m.NdJ("ngModelChange",function(e){return t.filterByGenre=e})("selectionChange",function(){return t.doGenreFilter()}),m.YNc(22,_,2,2,"mat-option",7),m.TgZ(23,"mat-option",8),m._uU(24," Clear Filter "),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(25,"span"),m.TgZ(26,"mat-form-field",5),m.TgZ(27,"mat-label"),m._uU(28,"Sorty By"),m.qZA(),m.TgZ(29,"mat-select",6),m.NdJ("ngModelChange",function(e){return t.sortBy=e})("selectionChange",function(){return t.updateSort()}),m.TgZ(30,"mat-option",8),m._uU(31," Sort by Year "),m.qZA(),m.TgZ(32,"mat-option",8),m._uU(33," Sort by Name "),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.YNc(34,M,2,0,"div",9),m.TgZ(35,"div",10),m.YNc(36,O,26,8,"ng-container",11),m.qZA(),m.qZA()),2&e&&(m.xp6(7),m.Q6J("formControl",t.searchField),m.xp6(6),m.Q6J("ngModel",t.filterByYear),m.xp6(1),m.Q6J("ngForOf",t.movieYears),m.xp6(1),m.Q6J("value",0),m.xp6(6),m.Q6J("ngModel",t.filterByGenre),m.xp6(1),m.Q6J("ngForOf",t.movieGenres),m.xp6(1),m.Q6J("value",0),m.xp6(6),m.Q6J("ngModel",t.sortBy),m.xp6(1),m.Q6J("value","year"),m.xp6(2),m.Q6J("value","name"),m.xp6(2),m.Q6J("ngIf",t.loading),m.xp6(2),m.Q6J("ngForOf",t.sortedAndFilteredMovies))},directives:[b.yH,b.xw,k.KE,k.hX,A.Nt,c.Fj,c.JJ,c.oH,w.gD,c.On,a.sg,q.ey,a.O5,b.SQ,T.g,b.Wh,S.lW],styles:[".movie[_ngcontent-%COMP%]{border:1px solid #673ab7;border-radius:5px;padding:15px 10px;margin-bottom:10px;min-width:250px}.home-page[_ngcontent-%COMP%]{padding:10px 20px}.skill-rating[_ngcontent-%COMP%]{font-weight:700;font-size:30px;border:1px solid;border-radius:10px;padding:10px 5px;line-height:35px;background-color:#000;color:#fff;max-height:55px}.genre-token[_ngcontent-%COMP%]{margin:3px;padding:3px 5px;border:1px solid #673ab7;border-radius:5px;background-color:#673ab7;color:#fff;font-size:10px;font-weight:700;display:inline-block}"],changeDetection:0}),Y)}],L=((I=function e(){r(this,e)}).\u0275fac=function(e){return new(e||I)},I.\u0275mod=m.oAB({type:I}),I.\u0275inj=m.cJS({providers:[],imports:[[a.ez,u.Bz,s.o9,c.u5,f.q,l.y,c.UX,u.Bz.forChild(Q)]]}),I)}}])}();