(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[435],{26435:function(e,t,i){"use strict";i.r(t),i.d(t,{HomeModule:function(){return M}});var r=i(61116),o=i(2937),n=i(31041),a=i(63337),s=i(56967),c=i(31431),l=i(92935),p=i(59472),u=i(47701),g=i(98720),f=i(66599),d=i(35366),h=i(59411),m=i(730),x=i(3492),v=i(38611),Z=i(35965),F=i(13070),y=i(9550),A=i(13841),q=i(87064),b=i(26470),w=i(84369);function k(e,t){if(1&e&&(d.TgZ(0,"mat-option",8),d._uU(1),d.qZA()),2&e){const e=t.$implicit;d.Q6J("value",e),d.xp6(1),d.hij(" ",e," ")}}function T(e,t){if(1&e&&(d.TgZ(0,"mat-option",8),d._uU(1),d.qZA()),2&e){const e=t.$implicit,i=d.oxw();d.Q6J("value",e),d.xp6(1),d.hij(" ",i.genreName[e]," ")}}function _(e,t){1&e&&(d.TgZ(0,"div",12),d._uU(1,"Searching...."),d.qZA())}function C(e,t){if(1&e&&(d.TgZ(0,"span",28),d._uU(1),d.qZA()),2&e){const e=t.$implicit,i=d.oxw(3);d.xp6(1),d.Oqu(i.genreName[e])}}function J(e,t){if(1&e&&(d.TgZ(0,"div",1),d._uU(1,"Genre: "),d.YNc(2,C,2,1,"span",27),d.qZA()),2&e){const e=d.oxw().$implicit;d.xp6(2),d.Q6J("ngForOf",e.genre)}}function U(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"button",29),d.NdJ("click",function(){d.CHM(e);const t=d.oxw().$implicit;return d.oxw().addToFavourites(t)}),d._uU(1," Add to Favourites "),d.qZA()}}function B(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"button",30),d.NdJ("click",function(){d.CHM(e);const t=d.oxw().$implicit;return d.oxw().removeFromFavourites(t)}),d._uU(1," Remove from Favourites "),d.qZA()}}function S(e,t){if(1&e){const e=d.EpF();d.ynx(0),d.TgZ(1,"div",13),d.TgZ(2,"div",14),d.TgZ(3,"div",1),d.TgZ(4,"app-photo-preview",15),d.NdJ("click",function(){const t=d.CHM(e).$implicit;return d.oxw().showMovieDetails(t)}),d.qZA(),d.qZA(),d.qZA(),d.TgZ(5,"div",16),d.TgZ(6,"div",17),d.TgZ(7,"div",18),d.NdJ("click",function(){const t=d.CHM(e).$implicit;return d.oxw().showMovieDetails(t)}),d._uU(8," Name: "),d.TgZ(9,"span",19),d._uU(10),d.qZA(),d.qZA(),d.TgZ(11,"div",1),d._uU(12,"Year: "),d.TgZ(13,"span",19),d._uU(14),d.qZA(),d.qZA(),d.YNc(15,J,3,1,"div",20),d.qZA(),d.TgZ(16,"div",21),d.TgZ(17,"div",22),d._uU(18,"Rating:"),d.qZA(),d.TgZ(19,"div",23),d.TgZ(20,"span"),d._uU(21),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(22,"div",24),d.YNc(23,U,2,0,"button",25),d.YNc(24,B,2,0,"button",26),d.qZA(),d.qZA(),d.BQk()}if(2&e){const e=t.$implicit;d.xp6(4),d.Q6J("size","40px")("photoURL",e.posterURL),d.xp6(6),d.Oqu(e.name),d.xp6(4),d.Oqu(e.year),d.xp6(1),d.Q6J("ngIf",e.genre.length),d.xp6(6),d.Oqu(e.rating),d.xp6(2),d.Q6J("ngIf",!e.isFavourite),d.xp6(1),d.Q6J("ngIf",e.isFavourite)}}const Y=[{path:"",component:(()=>{class e{constructor(e,t,i,r,o,n){this.dialog=e,this.usersService=t,this.cdr=i,this.stateService=r,this.toastr=o,this.apiService=n,this.movies=[],this.favourites=[],this.sortBy="name",this.loading=!1,this.readFavourites(),this.fetchGenres(),this.moviesSubscription=this.stateService.getUser().subscribe(e=>{e&&e.id?(this.activeUser=e,this.cdr.markForCheck()):(this.activeUser={},this.cdr.markForCheck())})}get movieYears(){return[...new Set(this.movies.map(e=>e.year))].sort((e,t)=>t-e)}get movieGenres(){const e=this.flatten(this.movies.map(e=>e.genre));return[...new Set(e)]}get sortedAndFilteredMovies(){let e=[...this.movies];return this.filterByYear&&(e=[...e.filter(e=>e.year===this.filterByYear)]),this.filterByGenre&&(e=[...e.filter(e=>e.genre.includes(this.filterByGenre))]),e}get favouriteMoviesIDs(){return this.favourites&&this.favourites.length?this.favourites.map(e=>e.id):[]}ngOnInit(){this.searchField=new n.NI,this.searchField.valueChanges.pipe((0,u.b)(600),(0,g.x)(),(0,f.b)(e=>{this.loading=!0}),(0,f.b)(e=>this.loading=!1)).subscribe(e=>{this.apiService.search(e).subscribe(e=>{let t;this.movies=[],e.results.forEach(e=>{t={name:e.original_title,year:e.release_date?e.release_date.split("-")[0]:"-",genre:e.genre_ids,rating:e.vote_average,posterURL:e.poster_path?"https://image.tmdb.org/t/p/w440_and_h660_face"+e.poster_path:"https://www.allianceplast.com/wp-content/uploads/2017/11/no-image.png",description:e.overview,id:e.id,isFavourite:this.favouriteMoviesIDs.includes(e.id)},this.movies.push(t)}),this.doSort(),this.cdr.markForCheck()})})}fetchGenres(){this.apiService.getGenres().subscribe(e=>{this.genreName=e.genres.reduce((e,t)=>(e[t.id]=t.name,e),{})})}readFavourites(){const e=localStorage.getItem("favourites");if(e){const t=JSON.parse(e);t&&(this.favourites=t,this.cdr.markForCheck())}}showMovieDetails(e){const t=new l.vA;t.width="500px",t.hasBackdrop=!0,t.closeOnNavigation=!0;const i=this.dialog.open(p.F,t);i.componentInstance.movie=e,i.afterClosed().subscribe(e=>{e&&this.cdr.markForCheck()})}updateSort(){this.doSort(),this.cdr.markForCheck()}doSort(){"year"===this.sortBy?this.movies.sort((e,t)=>t.year-e.year):"name"===this.sortBy&&this.movies.sort((e,t)=>e.name.localeCompare(t.name))}addToFavourites(e){e.isFavourite=!0;const t=this.movies.filter(e=>e.isFavourite);localStorage.setItem("favourites",JSON.stringify(t)),this.cdr.markForCheck()}removeFromFavourites(e){e.isFavourite=!1;const t=this.movies.filter(e=>e.isFavourite);localStorage.setItem("favourites",JSON.stringify(t)),this.cdr.markForCheck()}doYearFilter(){0===this.filterByYear&&(this.filterByYear=null,this.cdr.markForCheck())}doGenreFilter(){0===this.filterByGenre&&(this.filterByGenre=null,this.cdr.markForCheck())}flatten(e){return e.reduce((e,t)=>e.concat(Array.isArray(t)?this.flatten(t):t),[])}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(l.uw),d.Y36(h.K),d.Y36(d.sBO),d.Y36(m.b),d.Y36(x._W),d.Y36(v.s))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-home"]],decls:37,vars:12,consts:[["fxFlex","100","fxLayout","row wrap",1,"home-page"],["fxFlex","100"],["appearance","outline",1,"form-field"],["matInput","",3,"formControl"],["searchInput",""],["appearance","outline",1,"btr-form-field"],[3,"ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["class","searching","fxFlex","100",4,"ngIf"],["fxLayout","row wrap","fxLayoutGap","10px","fxFlex","100",1,"movies-container"],[4,"ngFor","ngForOf"],["fxFlex","100",1,"searching"],["fxFlex","1 1 24","fxFlex.lt-lg","0 1 48","fxFlex.lt-sm","0 1 95","fxLayout","row wrap",1,"movie"],["fxFlex","calc(50px)"],[3,"size","photoURL","click"],["fxFlex","calc(100%-50px)","fxLayout","row wrap"],["fxFlex","calc(100%-60px)","fxLayout","row wrap","fxLayoutAlign","start start",1,"user-info"],["fxFlex","100",1,"pointer",3,"click"],[1,"bold"],["fxFlex","100",4,"ngIf"],["fxFlex","calc(60px)","fxLayout","row wrap","fxLayoutAlign","center start",1,"skill-wrapper"],["fxFlex","100",1,"skill-label","text-center"],["fxFlex","100",1,"skill-rating","text-center","pointer"],["fxFlex","100","fxLayoutAlign","center center"],["mat-button","","color","primary",3,"click",4,"ngIf"],["mat-button","","color","warn",3,"click",4,"ngIf"],["class","genre-token",4,"ngFor","ngForOf"],[1,"genre-token"],["mat-button","","color","primary",3,"click"],["mat-button","","color","warn",3,"click"]],template:function(e,t){1&e&&(d.TgZ(0,"div",0),d.TgZ(1,"h2",1),d._uU(2,"Movie DB"),d.qZA(),d.TgZ(3,"span"),d.TgZ(4,"mat-form-field",2),d.TgZ(5,"mat-label"),d._uU(6,"Search Movies"),d.qZA(),d._UZ(7,"input",3,4),d.qZA(),d.qZA(),d.TgZ(9,"span"),d.TgZ(10,"mat-form-field",5),d.TgZ(11,"mat-label"),d._uU(12,"Filter By Year"),d.qZA(),d.TgZ(13,"mat-select",6),d.NdJ("ngModelChange",function(e){return t.filterByYear=e})("selectionChange",function(){return t.doYearFilter()}),d.YNc(14,k,2,2,"mat-option",7),d.TgZ(15,"mat-option",8),d._uU(16," Clear Filter "),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(17,"span"),d.TgZ(18,"mat-form-field",5),d.TgZ(19,"mat-label"),d._uU(20,"Filter By Genre"),d.qZA(),d.TgZ(21,"mat-select",6),d.NdJ("ngModelChange",function(e){return t.filterByGenre=e})("selectionChange",function(){return t.doGenreFilter()}),d.YNc(22,T,2,2,"mat-option",7),d.TgZ(23,"mat-option",8),d._uU(24," Clear Filter "),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(25,"span"),d.TgZ(26,"mat-form-field",5),d.TgZ(27,"mat-label"),d._uU(28,"Sorty By"),d.qZA(),d.TgZ(29,"mat-select",6),d.NdJ("ngModelChange",function(e){return t.sortBy=e})("selectionChange",function(){return t.updateSort()}),d.TgZ(30,"mat-option",8),d._uU(31," Sort by Year "),d.qZA(),d.TgZ(32,"mat-option",8),d._uU(33," Sort by Name "),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.YNc(34,_,2,0,"div",9),d.TgZ(35,"div",10),d.YNc(36,S,25,8,"ng-container",11),d.qZA(),d.qZA()),2&e&&(d.xp6(7),d.Q6J("formControl",t.searchField),d.xp6(6),d.Q6J("ngModel",t.filterByYear),d.xp6(1),d.Q6J("ngForOf",t.movieYears),d.xp6(1),d.Q6J("value",0),d.xp6(6),d.Q6J("ngModel",t.filterByGenre),d.xp6(1),d.Q6J("ngForOf",t.movieGenres),d.xp6(1),d.Q6J("value",0),d.xp6(6),d.Q6J("ngModel",t.sortBy),d.xp6(1),d.Q6J("value","year"),d.xp6(2),d.Q6J("value","name"),d.xp6(2),d.Q6J("ngIf",t.loading),d.xp6(2),d.Q6J("ngForOf",t.sortedAndFilteredMovies))},directives:[Z.yH,Z.xw,F.KE,F.hX,y.Nt,n.Fj,n.JJ,n.oH,A.gD,n.On,r.sg,q.ey,r.O5,Z.SQ,b.g,Z.Wh,w.lW],styles:[".movie[_ngcontent-%COMP%]{border:1px solid #673ab7;border-radius:5px;padding:15px 10px;margin-bottom:10px;min-width:250px}.home-page[_ngcontent-%COMP%]{padding:10px 20px}.skill-rating[_ngcontent-%COMP%]{font-weight:700;font-size:30px;border:1px solid;border-radius:10px;padding:10px 5px;line-height:35px;background-color:#000;color:#fff;max-height:55px}.genre-token[_ngcontent-%COMP%]{margin:3px;padding:3px 5px;border:1px solid #673ab7;border-radius:5px;background-color:#673ab7;color:#fff;font-size:10px;font-weight:700;display:inline-block}"],changeDetection:0}),e})()}];let M=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({providers:[],imports:[[r.ez,a.Bz,o.o9,n.u5,c.q,s.y,n.UX,a.Bz.forChild(Y)]]}),e})()}}]);